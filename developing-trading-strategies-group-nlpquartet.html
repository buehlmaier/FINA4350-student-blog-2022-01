<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://buehlmaier.github.io/FINA4350-student-blog-2022-01/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://buehlmaier.github.io/FINA4350-student-blog-2022-01/theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="FINA4350 Students" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content=", Progress Report, " />

<meta property="og:title" content="Developing Trading Strategies (Group NLPQuartet) "/>
<meta property="og:url" content="https://buehlmaier.github.io/FINA4350-student-blog-2022-01/developing-trading-strategies-group-nlpquartet.html" />
<meta property="og:description" content="By Group &#34;NLPQuartet,&#34; written by Kwok Tsun Hei and Tse Chun Hei After obtaining the sentiment score from four different sentiment analysis models, we started thinking about what we could do with the correlation between sentiment score and the stock price. We finally decided to build a trading strategy to …" />
<meta property="og:site_name" content="FINA4350 Student Blog" />
<meta property="og:article:author" content="FINA4350 Students" />
<meta property="og:article:published_time" content="2022-05-02T16:21:00+08:00" />
<meta name="twitter:title" content="Developing Trading Strategies (Group NLPQuartet) ">
<meta name="twitter:description" content="By Group &#34;NLPQuartet,&#34; written by Kwok Tsun Hei and Tse Chun Hei After obtaining the sentiment score from four different sentiment analysis models, we started thinking about what we could do with the correlation between sentiment score and the stock price. We finally decided to build a trading strategy to …">

        <title>Developing Trading Strategies (Group NLPQuartet)  · FINA4350 Student Blog
</title>
        <link href="https://buehlmaier.github.io/FINA4350-student-blog-2022-01/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="FINA4350 Student Blog - Full Atom Feed" />



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://buehlmaier.github.io/FINA4350-student-blog-2022-01/"><span class=site-name>FINA4350 Student Blog</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://buehlmaier.github.io/FINA4350-student-blog-2022-01
                                    >Home</a>
                                </li>
                                <li ><a href="https://buehlmaier.github.io/FINA4350-student-blog-2022-01/categories.html">Categories</a></li>
                                <li ><a href="https://buehlmaier.github.io/FINA4350-student-blog-2022-01/tags.html">Tags</a></li>
                                <li ><a href="https://buehlmaier.github.io/FINA4350-student-blog-2022-01/archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="https://buehlmaier.github.io/FINA4350-student-blog-2022-01/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://buehlmaier.github.io/FINA4350-student-blog-2022-01/developing-trading-strategies-group-nlpquartet.html">
                Developing Trading Strategies (Group NLPQuartet)
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>By Group "NLPQuartet," written by Kwok Tsun Hei and Tse Chun Hei</p>
<p>After obtaining the sentiment score from four different sentiment analysis models, we started thinking about what we could do with the correlation between sentiment score and the stock price. We finally decided to build a trading strategy to somehow implement what we have and to test the robustness of our findings.</p>
<h2>The 0.2 buy-sell strategy</h2>
<p>We came up with this strategy quite intuitively as it directly tells us if people view the stock as bullish or bearish and we hypothesized that a 0.2 change in sentiment score will represent that change of view. We started with no clue of whether to set the threshold at 0.2 or 0.3 or 0.4. Then we attempted all of them and concluded that 0.2 is the most reasonable one as the scale of the sentiment score is from -1 to 1, and it is not too often that the sentiment score changes would get too volatile; Meanwhile a 0.1 threshold will trigger some unreasonable trade that is too sensitive and may even be executed only due to errors. Thus, 0.2 seems to be a reasonable middle ground.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">change_buy_sell</span><span class="p">():</span>
    <span class="c1">#set ac_balance (Account Balance) as $1M</span>
    <span class="n">ac_balance</span> <span class="o">=</span> <span class="mi">1000000</span>
    <span class="c1">#set amount as number of stocks purchased</span>
    <span class="n">amount</span><span class="o">=</span><span class="mi">0</span>
    <span class="c1">#Set buy price</span>
    <span class="n">buyprice</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">#Set sell price </span>
    <span class="n">sellprice</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">#Set Ireturn(investment return) as price difference of each trade </span>
    <span class="n">Ireturn</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">securitiesMV</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="c1">#Intiate a list of return </span>
    <span class="n">Return</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sscore</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="c1">#buy_action</span>
            <span class="c1">#if sentiment score increases by 0.2 over a day</span>
             <span class="k">if</span><span class="p">(</span><span class="n">sscore</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">sscore</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&gt;=</span><span class="mf">0.2</span><span class="p">:</span>
            <span class="c1">#set the buy price of this trade </span>
                 <span class="n">buyprice</span> <span class="o">=</span> <span class="n">stock_price</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1">#calculte the amount of stock and Market Value of securities bought</span>
            <span class="c1">#The two lines below are the same but makes this code more readable</span>
                 <span class="n">amount</span> <span class="o">=</span> <span class="n">ac_balance</span><span class="o">/</span><span class="n">buyprice</span>
                 <span class="n">securitiesMV</span> <span class="o">=</span> <span class="n">amount</span> <span class="o">*</span> <span class="n">buyprice</span>

            <span class="c1">#sell_action </span>
            <span class="c1">#if sentiment score decreases by 0.2 over a day</span>
             <span class="k">elif</span><span class="p">(</span><span class="n">sscore</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">sscore</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=-</span><span class="mf">0.2</span><span class="p">:</span> 
                 <span class="c1">#set the sell price of this trade </span>
                 <span class="n">sellprice</span> <span class="o">=</span> <span class="n">stock_price</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                 <span class="c1">#calculte the Market Value of securities sold</span>
                 <span class="n">sellingMV</span> <span class="o">=</span> <span class="p">(</span><span class="n">amount</span><span class="o">*</span><span class="n">sellprice</span><span class="p">)</span>
                 <span class="c1">#Avoid calculating the price difference when there is no trade </span>
                 <span class="k">if</span> <span class="n">buyprice</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                     <span class="c1">#price difference </span>
                     <span class="n">Ireturn</span> <span class="o">=</span> <span class="n">sellingMV</span><span class="o">-</span> <span class="n">securitiesMV</span>  
                     <span class="c1">#Add to list</span>
                     <span class="n">Return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ireturn</span><span class="p">)</span>
                     <span class="c1">#Set to 0 and be ready to next trade</span>
                     <span class="n">buyprice</span> <span class="o">=</span> <span class="n">sellprice</span> <span class="o">=</span> <span class="n">amount</span> <span class="o">=</span> <span class="mi">0</span>
                     <span class="c1">#renewing Account Balance</span>
                     <span class="n">ac_balance</span> <span class="o">=</span> <span class="n">Ireturn</span> <span class="o">+</span> <span class="n">ac_balance</span>
    <span class="c1">#Calculate the ROI（％）</span>
    <span class="k">return</span>  <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">Return</span><span class="p">)</span><span class="o">/</span><span class="mi">1000000</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
</code></pre></div>

<h2>Cross strategy</h2>
<p>The 0.2 buy-sell strategy looks good but it is a rather rudimentary trading principle and a limited validation of our results. Therefore , we developed the Cross method which is similar to the Moving Average Convergence Divergence (MACD). The Cross strategy buys when the 2MA crosses above the 4MA(moving average) and sells when the opposite occurs. This strategy, unlike the 0.2 strategy , also considers the trends of emotions in news and twitter. </p>
<p>Also, for the scale, we were trying to micmic what people usually use the MACD, like looking at 20MA and 50MA etc, which means some 10s days. However, we found it is not reasonable for tweets and news as they may change rapidly due to some special announcements or firm’s activity. Therefore, we tried some combinations with 3 to 10 days MA, and found that 2 and 4 MA are the most profitable ones.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">cross_trade</span><span class="p">():</span>
    <span class="c1">#set amount of stock as 0 </span>
    <span class="n">amount</span><span class="o">=</span><span class="mi">0</span>
    <span class="c1">#set account balance as 1000000</span>
    <span class="n">Ac_balance</span><span class="o">=</span><span class="mi">1000000</span>
    <span class="c1">#set buy sell and return as 0</span>
    <span class="n">buyprice</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sellprice</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">Ireturn</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">securitiesMV</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="c1">#create a list for each return </span>
    <span class="n">Return</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">sscore</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1">#calculate 2day and 4day moving average </span>
        <span class="c1">#fl = fast line      sl = slow line </span>
        <span class="n">fl</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">sscore</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">sl</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">sscore</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">4</span>
        <span class="c1">#calculate 2day and 4dat moving average on a day before </span>
        <span class="c1">#in order to spot if there is a breakthough (cross)</span>
        <span class="c1">#cfl = fast line for comparsion      sl = slow line for comparsion </span>
        <span class="n">cfl</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">sscore</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">csl</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">sscore</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">4</span>


        <span class="c1">#trigger buy action if fast line is above slow line and </span>
        <span class="c1">#if there is a twit</span>
        <span class="c1">#twit = (slow line - buy price) changing from negative to positive </span>
        <span class="k">if</span> <span class="n">sl</span><span class="o">-</span><span class="n">fl</span> <span class="o">&lt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">cfl</span><span class="o">-</span><span class="n">csl</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fl</span><span class="o">-</span><span class="n">sl</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span> 
            <span class="c1">#buy action</span>
            <span class="c1">#set buy price </span>
            <span class="n">buyprice</span> <span class="o">=</span> <span class="n">stock_price</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1">#calculate amount of stock and securities market value </span>
            <span class="n">amount</span> <span class="o">=</span> <span class="n">Ac_balance</span><span class="o">/</span><span class="n">buyprice</span>
            <span class="n">securitiesMV</span> <span class="o">=</span> <span class="n">amount</span> <span class="o">*</span> <span class="n">buyprice</span>
       <span class="c1">#sell_action </span>
       <span class="c1">#trigger sell action if fast line is below slow line and </span>
       <span class="c1">#if there is a twit</span>
       <span class="c1">#twit = (slow line - buy price) changing from positive to negative </span>
        <span class="k">elif</span> <span class="n">sl</span><span class="o">-</span><span class="n">fl</span> <span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">cfl</span><span class="o">-</span><span class="n">csl</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fl</span><span class="o">-</span><span class="n">sl</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>   
           <span class="c1">#set sellprice and selling market value </span>
           <span class="n">sellprice</span> <span class="o">=</span> <span class="n">stock_price</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
           <span class="n">sellingMV</span> <span class="o">=</span> <span class="p">(</span><span class="n">amount</span><span class="o">*</span><span class="n">sellprice</span><span class="p">)</span>
           <span class="c1">#avoid selling before buying </span>
           <span class="k">if</span> <span class="n">buyprice</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
               <span class="c1">#calculate return (price difference)</span>
               <span class="n">Ireturn</span> <span class="o">=</span> <span class="n">sellingMV</span><span class="o">-</span><span class="n">securitiesMV</span>
               <span class="c1">#add return to the list </span>
               <span class="n">Return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ireturn</span><span class="p">)</span>
               <span class="c1">#set variable as 0 to be ready for next trade</span>
               <span class="n">buyprice</span> <span class="o">=</span> <span class="n">sellprice</span> <span class="o">=</span> <span class="n">amount</span> <span class="o">=</span> <span class="mi">0</span>
               <span class="c1">#renew account balance </span>
               <span class="n">Ac_balance</span> <span class="o">=</span> <span class="n">Ireturn</span> <span class="o">+</span> <span class="n">Ac_balance</span>
    <span class="c1">#return ROI (%)           </span>
    <span class="k">return</span>  <span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="n">Return</span><span class="p">))</span><span class="o">/</span><span class="mi">1000000</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
</code></pre></div>


             
 
            
            
            







            <hr/>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2022-05-02T16:21:00+08:00">Mon 02 May 2022</time>
            <h4>Category</h4>
            <a class="category-link" href="https://buehlmaier.github.io/FINA4350-student-blog-2022-01/categories.html#progress-report-ref">Progress Report</a>
<h4>Contact</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/buehlmaier/FINA4350-student-blog-2022-01" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://buehlmaier.github.io/FINA4350-student-blog-2022-01/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>